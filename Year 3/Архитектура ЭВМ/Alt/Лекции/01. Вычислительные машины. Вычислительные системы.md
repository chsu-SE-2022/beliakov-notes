**Вычислительная машина** - комплекс технических и программных средств, предназначенный для автоматизации подготовки и решения задач пользователей.  
**Вычислительная система** - совокупность взаимосвязанных и взаимодействующих процессоров или вычислительных машин, периферийного оборудования и программного обеспечения, предназначенная для подготовки и решения задач пользователей.  
## Принципы Фон-Неймана
1. **Принцип двоичного кодирования** - вся информация (данные и команды) кодируется двоичными числами 0 и 1. Последовательность битов, имеющая определенный смысл и формат, называется **полем**. В числовой информации выделяют поле знаков и поле значащих разрядов. В формате команды выделяют поле кода операции и поле адреса.
2. **Принцип программного управления** - все вычисления, предусмотренные алгоритмом решения задачи, должны быть представлены в виде программы, состоящей из последовательности управляющих слов - **команд**. Команды хранятся в последовательных ячейках памяти и выполняются в естественной последовательности одна за другой. При необходимости с помощью специальных команд эта последовательность может быть изменена.
3. **Принцип однородности памяти** - команды и данные хранятся в одной и той же памяти и внешне не различимы. Это позволяет производить над командами те же операции, что и над числами, вследствие принципа однородности. Команды одной программы могут быть получены как результат выполнения другой программы.  
	**Трансляция** - это перевод текста программы с языка более высокого уровня на язык конкретной вычислительной машины.  
	Подход к единой памяти был принят в вычислительных машинах, создававшихся в Принстонском университете. Вычислительные машины получили название **ЭВМ принстонской архитектуры**. Практически одновременно в Гарвардском университете были созданы вычислительные машины с отдельной памятью команд и отдельной памятью данных (**Гарвардская архитектура ЭВМ**)
4. **Принцип адресности** - память состоит из пронумерованных ячеек, причем процессору в любой момент времени доступна любая ячейка. Двоичные коды команд и данных разделяются на единицы информации - **слова**, и хранятся в ячейках памяти. Доступ к словам осуществляется по адресу (порядковому номеру ячейки). 
  
Структурная схема Фон-Неймановской машины:  
![Структурная схема Фон-Неймановской машины](../Pictures/01_01.%20Структурная%20схема%20Фон-Неймановской%20машины.png)  
## Типы структур вычислительных машин
Существует 2 основных способа построения вычислительных машин:
1. **Вычислительные машины с непосредственными связями**. Пример: Фон-Неймановская машина
2. **Вычислительные машины с общей шиной**. Все устройства подключаются к магистральной шине, в каждый момент времени передавать информацию по шине может только одно устройство  
	![Схема вычислительной машины с общей шиной](../Pictures/01_02.%20Схема%20вычислительной%20машины%20с%20общей%20шиной.png)  
## Типы структур вычислительных систем
К организации вычислительных систем также существует 2 подхода:
1. **Вычислительная система с общей памятью** - общая память совместно используется всеми процессорами системы. Связь между устройствами обеспечивается с помощью телекоммуникационной сети  
	![Схема вычислительной системы с общей памятью](../Pictures/01_03.%20Схема%20вычислительной%20системы%20с%20общей%20памятью.png)
2. **Распределенная вычислительная система** - общая память отсутствует, каждый процессор обладает своей локальной памятью. Обмен информацией обеспечивается посредством обмена сообщениями по коммуникационной сети  
	![Схема распределенной вычислительной системы](../Pictures/01_04.%20Схема%20распределенной%20вычислительной%20системы.png)
## Функциональная схема Фон-Неймановской вычислительной машины
![Функциональная схема Фон-Неймановской машины](../Pictures/01_05.%20Функциональная%20схема%20Фон-Неймановской%20машины.png)  
На функциональной схеме показаны типовые узлы каждого из основных устройств вычислительной машины, а также сигналы, инициирующие выполнение отдельных операций по пересылке и обработке информации.  
- **УУ** - устройство управления:
	- **СК** - счетчик команд - это двоичный счетчик, в котором хранится и модифицируется адрес очередной команды программы. Перед началом вычислений в СК заносится адрес ячейки основной памяти, где хранится первая команда. В процессе выполнения каждой команды путем увеличения содержимого СК на длину выполняемой команды в счетчике формируется адрес следующей команды. По завершению текущей команды адрес следующей команды берется из СК. Для изменения естественного порядка вычислений в СК заносится адрес точки перехода
	- **РК** - регистр команд - чтобы приступить к выполнению команды, ее необходимо извлечь из памяти и разместить в РК. Этот этап называется **выборкой команды**. В РК команда хранится в течение всего времени ее выполнения. Т. к. команда содержит 2 поля: поле ввода операции и поле адреса, то РК иногда рассматривают как совокупность 2 регистров: **РКОп** (регистр ввода операции) и **РА** (регистр адреса). Если команда занимает несколько последовательных ячеек, то код операции всегда находится в 1 слове команды. Это позволяет определить, требуется ли считывание из памяти и загрузка в РК остальных слов команды. Выполнение команды начинается только после занесения в РК ее полного кода
	- **УС** - указатель стека - это регистр, где хранится адрес вершины стека, т. е. ячейки, куда была произведена последняя по времени запись. Стек реализуется в виде участка основной памяти, обычно расположенного в области наибольших адресов. Заполнение стека происходит в сторону уменьшения адресов. При выполнении операции **push** содержимое указателя стека с помощью сигнала **-1УС** уменьшается на 1 и затем используется в качестве адреса для записи информации. Считывание из стека (операция **pop**) происходит из ячейки, на которую указывает текущий адрес УС, после чего содержимое УС увеличивается на 1. Таким образом, вершина стека опускается, считанное слово считается удаленным из стека
	- **РАП** - регистр адреса памяти - предназначен для хранения адреса ячейки памяти вплоть до завершения операции считывания или записи этой ячейки. Наличие РАП позволяет компенсировать различие в быстродействии основной памяти и остальных устройств машины
	- **РДП** - регистр данных памяти - в РДП при чтении заносится содержимое ячейки основной памяти, а при записи - информация, подлежащая сохранению в ОП. Момент считывания и записи определяется сигналами ЧтЗУ и ЗпЗУ
	- **ДКОп** - дешифратор кода операции - преобразует код операции в форму, требуемую для работы микропрограммного автомата. Эта информация после декодирования определяет последующие действия микропрограммного автомата, а ее вид зависит от организации МПА
	- **МПА** - микропрограммный автомат - формирует последовательность сигналов управления, в соответствии с которыми производится выборка из памяти и выполнение команды. Исходной информацией для МПА являются декодированный код операции, состояние признаков или флагов, характеризующих результат предыдущих вычислений, а также внешние запросы на прерывание текущей программы и переход на программу обслуживания прерывания
- **АЛУ** - арифметико-логическое устройство
	- **ОПБ** - операционный блок - выполняет арифметические и логические операции над поданными на вход операндами. Выбор конкретной операции определяется кодом операции, который поступает из РК. В реальных машинах код операции иногда преобразуется в МПА в иную форму и уже оттуда поступает в ОПБ. 
	- **РX** и **РY** - это регистры операндов, которые обеспечивают сохранение операндов на входе ОПБ до получения результата операции и его записи
	- **РПрз** - регистр признаков - предназначен для фиксации и хранения флагов, характеризующих результат последней выполненной операции. Под каждый флаг отводится 1 разряд регистра признаков. Содержимое регистра признаков используется устройством управления для реализации условных переходов. Формирование признаков осуществляется блоком формирования состояний регистра признаков, который может входить в состав ОПБ либо реализуется в виде внешней схемы, расположенной между ОПБ и регистром признаков
	- **Акк** - аккумулятор - выполняет множество функций. Например, в него может предварительно загружаться один из операндов, может хранится результат предыдущих операций, через него часто производятся операции ввода-вывода
- **ОП** - основная память - представляет собой массив запоминающих элементов, организованных в виде ячеек, способных хранить некоторую единицу информации (обычно - байт). Ячейки ОП организованы в виде матрицы и выбор ячейки осуществляется путем подачи разрешающих сигналов на соответствующую строку и столбец. Это обеспечивается дешифратором адреса памяти, преобразующим поступивший из РАП адрес ячейки в разрешающий сигнал. Для реализации данных сигналов используется несколько микросхем ЗУ. Тогда процесс обращения к ячейке состоит из выбора нужной микросхемы (старшие разряды адреса) и выбора ячейки внутри микросхемы (младшие разряды адреса)
- **УВВ** - устройство ввода-вывода - задачей УВВ является обеспечение подключения к вычислительной машине различных периферийных устройств и обмен информацией между ними
	- **ДВВ** - дешифратор ввода-вывода - обеспечивает преобразование номера порта в сигнал, разрешающий операции ввода или вывода. Ввод или вывод происходит при поступлении разрешающего сигнала из МПА
	- **Порт** - это схема, ответственная за передачу информации из периферийного устройства в аккумулятор или из аккумулятора на периферийное устройство вывода 
#### Основные стадии выполнения команды
В общем случае стандартный цикл команды состоит из 7 этапов:
1. **Выборка команды**. ЦП извлекает команду из памяти, используя адрес в счетчике команд. Двоичный код команды помещается в РК и с этого момента становится видимым процессором. В РК должен быть помещен полный код команды. Информация по фактической длине команды содержится в полях входа операции и адреса.
2. **Формирование адреса следующей команды**. Соседние команды находятся в смежных ячейках памяти. И для получения адреса следующей команды достаточно увеличить СК на длину текущей команды. Если извлеченная команда способна изменить последовательность выполнения программы, то процесс формирования адреса следующей команды переносится на этап исполнения операции.
3. **Декодирование команды**. ЦП расшифровывает находящийся в РК код операции и выясняет следующие моменты: 
	- находится ли в РК полный код команды
	- какие действие нужны для выполнения команды
	- откуда должны быть взяты операнды
	- куда должен быть записан результат операции
	  
	По результатам декодирования производится подготовка электронных схем машины для выполнения операции.
4. **Вычисление адресов операндов**. Осуществляется, если команда использует операнды. Если операнды помещаются в основной памяти, то на этом этапе выполняется вычисление их исполнительных адресов с учетом указанного в команде способа адресации
5. **Выборка операндов**. Операнды считываются из памяти и заносятся в определенные регистры АЛУ
6. **Исполнение операции**. Реализуется указанная операция
7. **Запись результата**. Присутствует в цикле тех команд, которые предполагают занесение результата в регистр или ячейку памяти
  
В зависимости от типа команды некоторые этапы могут отсутствовать. Однако, 1, 2, 3 и 6 этапы присутствуют всегда.  
В определенных ситуациях возможны еще 2 этапа: 
- **Машинный цикл с косвенной адресацией**. В простейшем случае в адресном поле указывается исполнительный адрес соответствующей ячейки памяти (**прямая адресация**). Часто используется **косвенная адресация** - это когда адрес операнда хранится в какой-то ячейке, а в команде указывается адрес ячейки, содержащей адрес операнда. Т. е. чтобы прочитать операнд, сначала нужно извлечь его адрес из памяти и только после этого произвести нужное действие, т. е. выполняются 2 обращения к памяти.
- **Машинный цикл с прерыванием**. Практически во всех вычислительных машинах предусмотрено средство, позволяющее некоторым устройствам прерывать выполнение текущей программы для внеочередного выполнения другой программы с последующим возвратом к прерванной. В терминах цикла команды: при наличии запроса ЦП приостанавливает выполнение текущей программы и запоминает содержимое всех регистров, которые будут использоваться программой обработки прерывания. Это называется **сохранение контекста программы**:
	1. В первую очередь необходимо сохранять содержимое СК, Акк и РПрз. Контекст программы обычно сохраняется в стеке. 
	2. ЦП заносит в СК начальный адрес программы обработки прерывания.
	3. Процессор продолжает цикл с этапа выборки первой команды обработчика. Обработчик, который обычно входит в состав ОС, определяет природу прерывания и выполняет необходимые действия
	4. Когда программа обработки прерывания завершена, процессор возобновляет выполнение программы пользователя, восстановив из стека контекст программы
