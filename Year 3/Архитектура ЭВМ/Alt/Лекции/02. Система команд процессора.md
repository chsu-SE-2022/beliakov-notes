Каждый процессор имеет собственный вполне определенных набор команд. Система команд должна обладать 2 свойствами:
1. **Функциональная полнота** - достаточность системы команд для описания любого алгоритма. Доказано, что свойством функциональной полноты обладает система, включающая 3 команды (т. н. система Поста):
	- Присвоение 0
	- Присвоение 1
	- Сравнение с 0
	  
	Однако, составление команд в такой системе крайне неэффективно.
2. **Эффективность** - степень соответствия системы команд назначению ЭВМ и требованиям производительности. 
  
Реализация развитой системы команд связана с большими затратами оборудования и высокой стоимостью процессора. В то же время ограниченный набор команд приводит к снижению производительности и повышенным требованиям к памяти для размещения программ.  
Система команд процессора характеризуется 3 аспектами: 
- форматами
- способами адресации
- системой операций
## Форматы команд
Машинные команды занимают от 1 до 6 байтов. Код операции занимает 1-2 первых байта. Т. к. операций слишком много, то для них не хватает 256 различных кодов, поэтому некоторые операции объединяются в группу и им дается один и тот же код операции, а во втором байте он уточняется. Также во 2 байте указываются типы операндов и способы их адресации. В остальных байтах команды указываются ее операнды. Команда может иметь от 0 до 2 операндов. Размер операндов - байт или слово. Операнд может быть указан в самой команде (непосредственный операнд), может находится в одном из регистров общего назначения (в команде указывается регистр) и может находится в ячейке памяти (в команде указывается адрес ячейки памяти).  
#### Основные форматы команд с 2 операндами
1) Регистр-регистр (2 байта)  
  
![Регистр-регистр](../Pictures/02_01.%20Регистр-регистр.png)  
- **коп** - код операции
- **d** - указывает, в какой из регистров (первый или второй) записывается результат:
	- **d = 1** - в первый регистр
	- **d = 0** - во второй регистр
- **w** - определяет размер операндов:
	- **w = 1** - слово
	- **w = 0** - байт
- Во втором байте 2 левых бита фиксированы, а 3-битовые поля **reg1** и **reg2** указывают на регистры, участвующие в операции
  
| reg | w = 1 (слово) | w = 0 (байт) |
| --- | ------------- | ------------ |
| 000 | AX            | AL           |
| 001 | CX            | CL           |
| 010 | DX            | DL           |
| 011 | BX            | BL           |
| 100 | SP            | AH           |
| 101 | BP            | CH           |
| 110 | SI            | DH           |
| 111 | DI            | BH           |
2) регистр-память (2-4 байта)
  
![Регистр-память](../Pictures/02_02.%20Регистр-память.png)  
- **коп** - код операции
- **d** - указывает, куда записывается результат
	- **d = 1** - результат записывается в регистр
	- **d = 0** - результат записывается в ячейку памяти
- **w** - определяет размер операндов:
	- **w = 1** - слово
	- **w = 0** - байт
- **mod** - определяет, сколько байтов в команде занимает операнд-адрес:
	- **mod = 00** - 0 байт
	- **mod = 01** - 1 байт
	- **mod = 10** - 2 байта
- **reg** - указывает операнд-регистр (в соответствии с таблицей выше)
- **mem** - указывает способ модификации адреса в соответствии с таблицей:
  
| mem\\mod | 00            | 01               | 10                |
| -------- | ------------- | ---------------- | ----------------- |
| 000      | \[BX\]+\[SI\] | \[BX\]+\[SI\]+a8 | \[BX\]+\[SI\]+a16 |
| 001      | \[BX\]+\[DI\] | \[BX\]+\[DI\]+a8 | \[BX\]+\[DI\]+a16 |
| 010      | \[BP\]+\[SI\] | \[BP\]+\[SI\]+a8 | \[BP\]+\[SI\]+a16 |
| 011      | \[BP\]+\[DI\] | \[BP\]+\[DI\]+a8 | \[BP\]+\[DI\]+a16 |
| 100      | \[SI\]        | \[SI\]+a8        | \[SI\]+a16        |
| 101      | \[DI\]        | \[DI\]+a8        | \[DI\]+a16        |
| 110      | a16           | \[BP\]+a8        | \[BP\]+a16        |
| 111      | \[BX\]        | \[BX\]+a8        | \[BX\]+a16        |
3) регистр-операнд (3-4 байта)
  
![Регистр-операнд](../Pictures/02_03.%20Регистр-операнд.png)  
- **im** - непосредственный операнд
	- Если **s = 1** и **w = 1**, то **im** задан байтом и перед выполнением операции он автоматически расширяется до слова
  
4) память-операнд (3-6 байтов)
  
![Память-операнд](../Pictures/02_04.%20Память-операнд.png)
## Способы адресации
**Способ адресации** определяет, каким образом следует использовать информацию, размещенную в поле адреса команды. Существует 5 основных способов адресации операнда в команде:
1. **Прямая адресация:** в поле адреса располагается адрес операнда, который может находится либо в ячейке, либо в регистре общего назначения (прямая регистровая адресация). Поле адреса регистра в команде имеет значительно меньшую длину, чем адрес ячейки памяти. 
2. **Непосредственная адресация**: в поле адреса команды располагается сам операнд. Такой способ часто используется в командах с константами
3. **Косвенная адресация**: разновидность косвенной адресации - косвенно-регистровая адресация, при которой в поле адреса команды размещается адрес регистра общего назначения, хранящего адрес операнда. 
4. **Относительная адресация**: адрес формируется как сумма 2 слагаемых - базы, хранящейся в специальном регистре или в одном их регистров общего назначения, и смещения извлекаемого из поля адреса команды. Этот способ позволяет сократить длину команды. Разновидности: 
	- **Индексная адресация** - предполагает наличие индексного регистра вместо базового. При каждом обращении содержимое индексного регистра уменьшается или увеличивается на 1
	- **Базово-индексная адресация** - формирует адрес операнда как сумму 3 слагаемых: база + индекс + смещение
5. **Безадресная адресация**: поле адреса в команде отсутствует, либо адрес операнда не имеет смысла, либо подразумевается по умолчанию. Разновидности: стек и очередь
## Система операций
Все операции, выполняемые в командах, принято делить на 5 классов:
1. **Арифметико-логические и специальные операции** - это операции, в которых выполняется преобразование информации
2. **Операции пересылки и загрузки** - обеспечивают передачу информации между процессором и памятью или между различными уровнями памяти
3. **Операции ввода-вывода** - обеспечивают передачу информации между процессором и внешними устройствами. Если в ЭВМ единое адресное пространство, то класс операций ввода-вывода не выделяется в отдельный класс
4. **Операции передачи управления** - это команды, которые изменяют естественный порядок выполнения программы. Эти команды меняют содержимое счетчика команд, обеспечивая переходы. Существуют команды безусловной и условной передачи управления. Различают 3 типа команд передачи управления: 
	- **Команды перехода** - размещают в счетчике команд содержимое своего адресного поля - адрес перехода
	- **Команды вызова подпрограммы** - работают подобно команде безусловного перехода, но старое значение счетчика команд предварительно сохраняется в специальном регистре или стеке
	- **Команда возврата** - передает содержимое верхушки стека или специального регистра в счетчик команд
5. **Системные операции** - это команды, выполняющие управление процессом обработки информации и внутренними ресурсами процессора
## Классификация архитектуры систем команд
![Классификация архитектуры систем команд](../Pictures/02_05.%20Классификация%20архитектуры%20систем%20команд.png)  
- **Аккумуляторная архитектура** - в ней для хранения одного из операндов используется выделенный регистр-аккумулятор. В этот же регистр заносится и результат. Поскольку адрес одного из операндов уже известен, то в командах указывается только адрес второго операнда: умножения и деления. Поэтому достоинство аккумуляторной архитектуры - короткие команды и простота декодирования команд. Недостатки - наличие всего одного регистра порождает многократное обращение к памяти.  
	![Аккумуляторная архитектура системы команд](../Pictures/02_06.%20Аккумуляторная%20архитектура%20системы%20команд.png)
- **Регистровая архитектура** - в этой архитектуре процессор включает в себя массив регистров общего назначения, размер регистров фиксирован и совпадает с размером машинного слова. К любому регистру можно обратиться, указав его номер. Операнды могут располагаться либо в ячейке основной памяти, либо в регистре. Поэтому выделяют 3 вида форматов команд: регистр-регистр, регистр-память и память-память. Достоинства: компактность получаемого кода, высокая скорость выполнения. Однако, требует более длинных инструкций, чем аккумуляторная.  
	![Регистровая архитектура системы команд](../Pictures/02_07.%20Регистровая%20архитектура%20системы%20команд.png)
- **Архитектура с выделенным доступом к памяти** - обращение к основной памяти возможно только с помощью 2 специальных команд: загрузка и сохранение. Отсутствуют команды обработки с прямым обращением к памяти. Присутствует ограниченное число команд, где операнд объявляется частью кода команды. Достоинства: простота декодирования и исполнения команд.  
	![Архитектура системы команд с выделенным доступом к памяти](../Pictures/02_08.%20Архитектура%20системы%20команд%20с%20выделенным%20доступом%20к%20памяти.png)
- **Архитектура с полным набором команд (CISC)** - основоположником считается компания IBM. Аналогичный подход характерен и для компании Intel в микропроцессорах серии 8086 и Pentium. Для CISC-архитектуры характерно:
	1. Наличие в процессоре небольшого количества регистров общего назначения
	2. Наличие большого количества машинных команд
	3. Разнообразие способов адресации операндов
	4. Множество форматов команд различной разрядности
	5. Наличие команд, где обработка совмещается с обращением к памяти
- **Архитектура с сокращенным набором команд (RISC)** - термин RISC впервые был введен в 1980 году. Ограниченный список команд, в который включены наиболее часто используемые простейшие команды, в которых операнды размещены в регистрах процессора. Обращение к памяти допускается с помощью специальных команд чтения-записи. Резко уменьшено количество форматов команд и способов адресации. 
- **Архитектура со словами сверхбольшой длины (VLIW)** - базируется на RISC-архитектуре, где несколько простых команд объединяются в одну сверхдлинную команду и выполняются параллельно
- **Стековая архитектура** - достоинства - возможность сокращения адресной части команд, простота декодирования. 
	![Стековая архитектура системы команд](../Pictures/02_09.%20Стековая%20архитектура%20системы%20команд.png)