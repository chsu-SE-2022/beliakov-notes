## Принцип микропрограммного управления
Для выполнения операций над информацией используются **операционные устройства** - арифметико-логические, управления, контроллеры ВУ и т. п. Функцией операционного устройства является выполнение заданного множества операций $F=\{f_1,f_2,...,f_K\}$ над входными словами из множества $D_I$ с целью вычисления выходных слов из множества $D_O$, представляющих результаты операций $D_O=f_K(D_I)$, $k=1,...,K$.  
Функциональная и структурная организация операционных устройств, определяющая порядок функционирования и структуру устройств, базируется на **принципе микропрограммного управления**, который состоит в следующем: 
1. Любая операция $f_k$, реализуемая устройством, рассматривается как сложное действие, которое разделяется на последовательность элементарных действий над словами информации, называемых **микрооперациями**. 
2. Для управления порядком следования микроопераций используются **логические условия**, которые, в зависимости от значений слов, преобразуемых микрооперациями, принимают значения "истина" или "ложь" (1 или 0). 
3. Процесс выполнения операций в устройстве описывается в форме алгоритма, представляемого в терминах микроопераций и логических условий и называемого **микропрограммой**. Микропрограмма определяет порядок проверки значений логических условий и следования микроопераций, необходимый для получения требуемых результатов. 
4. Микропрограмма используется как форма представления функции устройства, на основе которой определяются структура и порядок функционирования устройства во времени.
  
Сказанное можно рассматривать как содержательное описание принципа микропрограммного управления, из которого следует, что структура и порядок функционирования операционного устройства предопределяются **алгоритмами выполнения операций из $F$**.
## Концепция операционного и управляющего автоматов
В функциональном и структурном отношении операционное устройство, входящее в состав ЭВМ, удобно представить разделенным на две части: операционный и управляющий автоматы.  
![Устройство как композиция автоматов](ДЗ_01.%20Устройство%20как%20композиция%20автоматов.png)  
**Операционный автомат (ОА)** служит для хранения слов информации, выполнения набора микроопераций и вычисления значений логических условий, т. е. операционный автомат является структурой, организованной для выполнения действий над информацией. На вход ОА подаются входные данные $D_I$, которые в соответствии с алгоритмом операции преобразуются в выходные данные $D_O$. Кроме того, ОА вырабатывает множество $\{x\}$ осведомительных сигналов (логических условий) для управляющего автомата.  
**Управляющий автомат (УА)** генерирует последовательность управляющих сигналов $\{y\}$, обеспечивающую выполнение в операционном автомате заданной последовательности элементарных действий, которая реализует алгоритм выполняемой операции. Управляющая последовательность генерируется в соответствии с заданным алгоритмом и с учетом значений логических условий x , формируемых ОА.  
Часто операционное устройство может выполнять несколько различных операций (например, арифметико-логическое устройство может выполнять четыре арифметических действия и несколько логических операций над входными словами). В этом случае на вход УА поступает команда $C$, определяющая тип выполняемой операции. Кроме того, поскольку различные операции над различными данными выполняются за разное время, УА формирует сигнал $g$, отмечающий окончание операции и готовность выходных данных.  
Таким образом, любое операционное устройство - процессор (который обычно, в свою очередь, представляют состоящим из двух операционных устройств: АЛУ - арифметико-логического устройства и ЦУУ - центрального устройства управления), канал ввода/вывода, контроллер внешнего устройства - можно представить как композицию **операционного** и **управляющего автоматов**. Операционный автомат, реализуя действия над словами информации, является исполнительной частью устройства, работу которого организует управляющий автомат, генерирующий необходимые последовательности управляющих сигналов.  
Такой подход позволяет разработать эффективные процедуры синтеза ОА и УА, формализовать эти процедуры и, в некоторых случаях, автоматизировать процесс синтеза цифровых устройств.
## Операционный автомат
Исходными для разработки структуры операционного автомата (ОА) являются: 
- описание входных и выходных слов ОА (множеств $D_I$ и $D_O$); 
- список множества операций из $F$, которые должны выполняться над словами. 
  
Процесс разработки ОА, таким образом, следует начинать с определения **форматов входных** и **выходных слов** и разработки алгоритмов выполнения операций в терминах слов и стандартных действий над словами (сложение, копирование, инверсия, сдвиг и т. д.). Разработанные алгоритмы удобно представить в форме **граф-схемы алгоритма (ГСА)**.  
Далее необходимо разработать структуру ОА. Операционный автомат строится на базе операционных и логических элементов. Предложенные процедуры формального синтеза ОА не получили широкого распространения; обычно используют так называемый "содержательный" метод синтеза.  
Разработать структуру - значит **определить набор элементов**, входящих в нее, и **установить связи** между этими элементами. Структура реализуется, исходя из разработанных на предыдущем этапе алгоритмов таким образом, чтобы обеспечить реализацию всех действий, предусмотренных в операторных вершинах ГСА.  
Действия в структуре ОА выполняются под управлением микроопераций, поэтому при разработке ОА следует определить **полный список микроопераций**, наличие которых обеспечит выполнение в разработанной структуре всех предусмотренных в алгоритмах преобразований слов.  
Наконец, формирование последовательности микроопераций в управляющем автомате осуществляется с учетом значений логических условий, которые формируются в ОА. Поэтому при разработке ОА следует сформировать **список логических условий**, определяемый содержимым условных вершин ГСА, и предусмотреть в структуре ОА (если это необходимо) специальные элементы для формирования этих логических условий.  
Итак, процесс разработки ОА можно представить состоящим из следующих этапов: 
1. Определение форматов входных и выходных данных (слов). 
2. Разработка ГСА выполняемых операций. 
3. Разработка структуры ОА - выбор элементов и организация связей. 
4. Определения множества $\{y\}$ микроопераций, выполняемых в ОА. 
5. Определения множества $\{x\}$ логических условий, формируемых в ОА.
## Управляющий автомат
Исходным для проектирования управляющего автомата (УА) является микропрограмма, представленная, например, в форме ГСА.  
Различают два класса управляющих автоматов : 
- с "жесткой" логикой: 
	- автомат Мура; 
	- автомат Мили; 
	- С-автомат;
- с программируемой логикой.
#### Управляющий автомат с "жесткой" логикой
Автоматы с "жесткой" логикой проектируются как обычные конечные структурные автоматы.  
Сначала необходимо перейти от ГСА микропрограммы к графу автомата, для чего следует: 
1. Разметить исходную микропрограмму. 
2. Построить по размеченной микропрограмме граф автомата. 
  
Далее реализуются стандартные процедуры синтеза структурного автомата, заданного графом:
- кодирование алфавита входных и выходных символов автомата двоичными кодами;
- кодирование внутренних состояний автомата;
- выбор элемента памяти (типа триггера);
- построение автоматной таблицы переходов;
- синтез комбинационной схемы, реализующей функцию переходов КСх 1;
- синтез комбинационной схемы, реализующей функцию выходов КСх 2.
  
Процедура **разметки микропрограммы** ставит в соответствие символам состояний автомата $(a_1, a_2, ..., a_M)$ некоторые объекты микропрограммы. Способы разметки микропрограмм различаются для автоматов различных типов.  
Для автомата Мура разметка выполняется по следующим правилам: 
- символом $a_1$ отмечается начальная и конечная вершина ГСА;
- различные операторные вершины отмечаются разными символами состояний; 
- все операторные вершины должны быть отмечены. 
  
Для автомата Мили разметка выполняется по следующим правилам: 
- символом $a_1$ отмечается вход вершины, следующей за начальной, а также вход конечной вершины; 
- входы всех вершин, следующих за операторными, должны быть отмечены символами состояний; 
- если вход вершины отмечается, то лишь одним символом; 
- входы различных вершин, за исключением конечной, отмечаются различными символами.