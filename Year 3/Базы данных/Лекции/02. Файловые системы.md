## Файловые системы
**Файл** - именованная область внешней памяти, куда можно записать, и откуда считать данные.  
Конкретная файловая система определяет правила именования файлов, структуру файлов, способ доступа к данным файла. Она же распределяет внешнюю память, отображает имена файлов в соответствующие адреса ВЗУ, обеспечивает доступ к данным.  
Первая файловая система была предложена фирмой IBM (CTSS, о которой известно засчёт [IBM CC-208](https://people.csail.mit.edu/saltzer/CTSS/CTSS-Documents/CC-Memos/CC-208.pdf)). В ней файл - абстрактное понятие, ему соответствовал любой внешний объект.  
Сегодня основа ВЗУ - магнитный диск с подвижными головками - это пакет магнитных пластин, между которыми пакет магнитных головок. Шаг движения головок - дискретный. Каждому движению головок соответствует цилиндр магнитного диска. Каждая дорожка размещается на одинаковом количестве блоков так, чтобы в каждой записать по максимуму одно и то же число байт. Для обмена с магнитным диском надо знать номер цилиндра, номер поверхности, номер блока на дорожке, число байт, которое нужно записать или прочитать от начала блока.  
Сначала существовало 2 подхода к реализации файлов:
1. ОС фирмы DEC: файл - это последовательность байт постоянного или переменного размера. Ее можно читать, записывать последовательно или переходить на запись с указанным номером. Записи структурированы на поля. Поля можно объявлять ключевыми
2. ОС фирмы Unix: файл - это последовательность байт, из файла читают указанное число байт, начиная с начала либо с указанного байта
  
Современные файловые системы поддерживают многоуровневое именование файлов за счет поддержания во внешней памяти дополнительных файлов - **каталогов** (папок, директорий). Таким образом, полный путь файла состоит из списка имен каталогов + имя файла. 

Большинство файловых систем в своей основе держат определённую структуру данных для хранения данных о директориях и их структуре, а также для выделения пространства для файлов

| Файловая система | ОС                    | Структура данных для метадаты | Структура данных для аллокации |
| ---------------- | --------------------- | ----------------------------- | ------------------------------ |
| ext4             | Linux                 | B-дерево с хэшированием       | Bitmap                         |
| ext3             | Linux                 | B-дерево с хэшированием       | Bitmap/Extents                 |
| ext2             | Linux                 | Таблица                       | Bitmap/Extents                 |
| FAT*             | MS-DOS, Windows 95/98 | Таблица                       | Связный список                 |
| BCacheFS         | Linux                 | Гибридное B+дерево            | Extents                        |
| btrfs            | Linux                 | B-дерево                      | Extents                        |
| APFS             | macOS, iOS            | B-дерево                      | -                              |

Область применения файлов:
- Текстовые документы - последовательность записей со строками текста и байт со специальными символами
- Объектные модули - последовательность записей или байт, определяемых системой программирования и неизвестных файловой системе
- Содержащие образы выполняемых программ - структура известна редактору связи и загрузчику ОС
- Файлы с графической, звуковой информацией, файлы документов
  
